import pandas as pd
import numpy as np

from sklearn.svm import SVR
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_absolute_error,mean_squared_error



df = pd.read_excel('AL_WIND_07_12.xlsx')

df['Time'] = df['DateTime'].dt.hour

df = df.drop(['DateTime'],axis=1) 

Y = df['Power generated by system | (kW)']
X = df.drop(['Power generated by system | (kW)'],axis=1)

X_train,X_test,Y_train,Y_test = train_test_split(X,Y, test_size=0.33, random_state=42)

model1 = RandomForestRegressor(n_estimators=100, criterion='mae', n_jobs=1)
model2 = SVR()

model1.fit(X_train,Y_train)
model2.fit(X_train,Y_train)

preds1 = model1.predict(X_test)
preds2 = model2.predict(X_test)

df['RFR_predictions'] = pd.DataFrame(preds1)
df['SVR_predictions'] = pd.DataFrame(preds2)
df.to_csv('Sklearn_wind_predictions.csv')

print(mean_absolute_error(preds1,Y_test))
print(mean_absolute_error(preds2,Y_test))

print(np.sqrt(mean_squared_error(preds1,Y_test)))
print(np.sqrt(mean_squared_error(preds2,Y_test)))
